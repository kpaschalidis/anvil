<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ZATAP Platform Architecture</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: #f5f5f5;
      padding: 20px;
      margin: 0;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      background: white;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    h2 {
      color: #333;
      margin-bottom: 10px;
    }

    .subtitle {
      color: #666;
      font-size: 14px;
      margin-bottom: 30px;
    }

    svg text {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    }

    .info-box {
      margin-top: 30px;
      padding: 20px;
      background: #f9f9f9;
      border-radius: 5px;
      border-left: 4px solid #4A90E2;
    }

    .info-box h3 {
      margin-top: 0;
      color: #333;
      font-size: 16px;
    }

    .info-item {
      margin: 8px 0;
      font-size: 13px;
      color: #555;
    }

    .section-divider {
      margin: 40px 0;
      border-top: 2px solid #e0e0e0;
    }

    h3.flow-title {
      color: #4A90E2;
      margin-top: 30px;
      margin-bottom: 20px;
      font-size: 18px;
    }
  </style>
</head>

<body>
  <div class="container">
    <h2>ZATAP Platform Architecture</h2>
    <p class="subtitle">NFC-Enabled Phygital Experience Platform - Workflow Diagram</p>

    <!-- Consumer Flow -->
    <h3 class="flow-title">1. Consumer Experience Flow (End User - NFC Tap)</h3>
    <svg viewBox="0 0 1200 550" style="width: 100%; height: auto;">
      <!-- Consumer -->
      <rect x="50" y="220" width="100" height="70" fill="#4A90E2" stroke="#357ABD" stroke-width="2" rx="5" />
      <text x="100" y="250" text-anchor="middle" fill="white" font-size="13" font-weight="bold">Consumer</text>
      <text x="100" y="268" text-anchor="middle" fill="white" font-size="10">(Mobile Phone)</text>

      <!-- Arrow 1: NFC Tap -->
      <line x1="150" y1="255" x2="210" y2="255" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)" />
      <text x="180" y="245" text-anchor="middle" font-size="10" fill="#666">1. Tap</text>

      <!-- NFC Tag -->
      <rect x="210" y="225" width="90" height="60" fill="#F39C12" stroke="#D68910" stroke-width="2" rx="5" />
      <text x="255" y="250" text-anchor="middle" fill="white" font-size="12" font-weight="bold">NFC Tag</text>
      <text x="255" y="268" text-anchor="middle" fill="white" font-size="9">(Physical Product)</text>

      <!-- Arrow 2: URL with CMAC -->
      <line x1="300" y1="255" x2="360" y2="255" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)" />
      <text x="330" y="245" text-anchor="middle" font-size="10" fill="#666">2. URL</text>
      <text x="330" y="275" text-anchor="middle" font-size="9" fill="#666">(CMAC params)</text>

      <!-- Consumer WebApp -->
      <rect x="360" y="210" width="120" height="90" fill="#50C878" stroke="#3DA85D" stroke-width="2" rx="5" />
      <text x="420" y="240" text-anchor="middle" fill="white" font-size="13" font-weight="bold">Consumer</text>
      <text x="420" y="258" text-anchor="middle" fill="white" font-size="13" font-weight="bold">WebApp</text>
      <text x="420" y="278" text-anchor="middle" fill="white" font-size="9">(React, Public)</text>

      <!-- Arrow 3: Verify CMAC -->
      <line x1="480" y1="255" x2="560" y2="255" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)" />
      <text x="520" y="245" text-anchor="middle" font-size="10" fill="#666">3. Verify</text>
      <text x="520" y="275" text-anchor="middle" font-size="9" fill="#666">CMAC</text>

      <!-- Backend API -->
      <rect x="560" y="210" width="120" height="90" fill="#9B59B6" stroke="#7D3C98" stroke-width="2" rx="5" />
      <text x="620" y="240" text-anchor="middle" fill="white" font-size="13" font-weight="bold">Backend API</text>
      <text x="620" y="258" text-anchor="middle" fill="white" font-size="10">(Node.js/GKE)</text>
      <text x="620" y="278" text-anchor="middle" fill="white" font-size="9">TLS 1.2+</text>

      <!-- Arrow 4: Query -->
      <line x1="680" y1="255" x2="760" y2="255" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)" />
      <text x="720" y="245" text-anchor="middle" font-size="10" fill="#666">4. Query</text>

      <!-- Cloud SQL -->
      <rect x="760" y="210" width="140" height="90" fill="#E74C3C" stroke="#C0392B" stroke-width="2" rx="5" />
      <text x="830" y="235" text-anchor="middle" fill="white" font-size="13" font-weight="bold">Cloud SQL</text>
      <text x="830" y="253" text-anchor="middle" fill="white" font-size="9">(PostgreSQL)</text>
      <text x="830" y="270" text-anchor="middle" fill="white" font-size="8">Config, mappings,</text>
      <text x="830" y="284" text-anchor="middle" fill="white" font-size="8">tenant data, forms</text>

      <!-- Cloud Storage -->
      <rect x="760" y="330" width="140" height="70" fill="#3498DB" stroke="#2874A6" stroke-width="2" rx="5" />
      <text x="830" y="355" text-anchor="middle" fill="white" font-size="13" font-weight="bold">Cloud Storage</text>
      <text x="830" y="373" text-anchor="middle" fill="white" font-size="9">(GCS)</text>
      <text x="830" y="388" text-anchor="middle" fill="white" font-size="8">Images, videos</text>

      <!-- Arrow: Backend to Storage -->
      <line x1="620" y1="300" x2="760" y2="365" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)" />
      <text x="680" y="340" font-size="10" fill="#666">5. Fetch</text>

      <!-- Return arrow -->
      <line x1="560" y1="270" x2="480" y2="270" stroke="#666" stroke-width="2" marker-end="url(#arrowhead-gray)"
        stroke-dasharray="5,5" />
      <text x="520" y="290" text-anchor="middle" font-size="10" fill="#666">6. Render</text>

      <!-- Form submission box -->
      <rect x="360" y="340" width="280" height="80" fill="#ECF0F1" stroke="#BDC3C7" stroke-width="2" rx="5" />
      <text x="500" y="360" text-anchor="middle" fill="#333" font-size="11" font-weight="bold">7. Optional: Form
        Submission</text>
      <text x="380" y="385" fill="#555" font-size="9">• Processor mode: stored in Cloud SQL</text>
      <text x="380" y="405" fill="#555" font-size="9">• Pass-through: sent to client systems (not stored)</text>

      <!-- Edge Path Box -->
      <rect x="50" y="450" width="850" height="60" fill="#2ECC71" stroke="#27AE60" stroke-width="2" rx="5" />
      <text x="475" y="475" text-anchor="middle" fill="white" font-size="11" font-weight="bold">Edge Path (Custom
        Domains):</text>
      <text x="475" y="495" text-anchor="middle" fill="white" font-size="10">Cloudflare SaaS → GCP Load Balancer + Cloud
        Armor → GKE Backend</text>

      <!-- Note box -->
      <rect x="950" y="210" width="230" height="90" fill="#FFF3CD" stroke="#FFC107" stroke-width="2" rx="5" />
      <text x="1065" y="235" text-anchor="middle" fill="#856404" font-size="11" font-weight="bold">Access Control</text>
      <text x="965" y="260" fill="#856404" font-size="9">No consumer authentication</text>
      <text x="965" y="278" fill="#856404" font-size="9">required. Access controlled by</text>
      <text x="965" y="296" fill="#856404" font-size="9">cryptographic tag verification.</text>

      <!-- Arrow marker definitions -->
      <defs>
        <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
          <polygon points="0 0, 10 3, 0 6" fill="#333" />
        </marker>
        <marker id="arrowhead-gray" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
          <polygon points="0 0, 10 3, 0 6" fill="#666" />
        </marker>
      </defs>
    </svg>

    <div class="section-divider"></div>

    <!-- Studio Flow -->
    <h3 class="flow-title">2. Studio Management Flow (Customer Users)</h3>
    <svg viewBox="0 0 1200 450" style="width: 100%; height: auto;">
      <!-- Customer User -->
      <rect x="50" y="180" width="100" height="70" fill="#E67E22" stroke="#CA6F1E" stroke-width="2" rx="5" />
      <text x="100" y="210" text-anchor="middle" fill="white" font-size="13" font-weight="bold">Customer</text>
      <text x="100" y="228" text-anchor="middle" fill="white" font-size="13" font-weight="bold">User</text>

      <!-- Arrow: HTTPS -->
      <line x1="150" y1="215" x2="230" y2="215" stroke="#333" stroke-width="2" marker-end="url(#arrowhead2)" />
      <text x="190" y="205" text-anchor="middle" font-size="10" fill="#666">1. HTTPS</text>

      <!-- Studio WebApp -->
      <rect x="230" y="170" width="120" height="90" fill="#50C878" stroke="#3DA85D" stroke-width="2" rx="5" />
      <text x="290" y="200" text-anchor="middle" fill="white" font-size="13" font-weight="bold">Studio</text>
      <text x="290" y="218" text-anchor="middle" fill="white" font-size="13" font-weight="bold">WebApp</text>
      <text x="290" y="238" text-anchor="middle" fill="white" font-size="9">(React)</text>

      <!-- Arrow: Auth -->
      <line x1="290" y1="170" x2="290" y2="100" stroke="#333" stroke-width="2" marker-end="url(#arrowhead2)" />
      <text x="310" y="130" font-size="10" fill="#666">2. Auth</text>

      <!-- Auth0 -->
      <rect x="230" y="50" width="120" height="50" fill="#EB5424" stroke="#C43E1C" stroke-width="2" rx="5" />
      <text x="290" y="80" text-anchor="middle" fill="white" font-size="13" font-weight="bold">Auth0</text>

      <!-- Return JWT -->
      <line x1="310" y1="100" x2="310" y2="170" stroke="#666" stroke-width="2" marker-end="url(#arrowhead2-gray)"
        stroke-dasharray="5,5" />
      <text x="340" y="130" font-size="10" fill="#666">3. JWT</text>

      <!-- Arrow: API Calls -->
      <line x1="350" y1="215" x2="430" y2="215" stroke="#333" stroke-width="2" marker-end="url(#arrowhead2)" />
      <text x="390" y="205" text-anchor="middle" font-size="10" fill="#666">4. REST API</text>

      <!-- Backend API -->
      <rect x="430" y="170" width="120" height="90" fill="#9B59B6" stroke="#7D3C98" stroke-width="2" rx="5" />
      <text x="490" y="200" text-anchor="middle" fill="white" font-size="13" font-weight="bold">Backend API</text>
      <text x="490" y="218" text-anchor="middle" fill="white" font-size="10">(Node.js/GKE)</text>
      <text x="490" y="238" text-anchor="middle" fill="white" font-size="9">RBAC Enforced</text>

      <!-- Arrow: Save Data -->
      <line x1="550" y1="215" x2="630" y2="215" stroke="#333" stroke-width="2" marker-end="url(#arrowhead2)" />
      <text x="590" y="205" text-anchor="middle" font-size="10" fill="#666">5. Save</text>

      <!-- Cloud SQL -->
      <rect x="630" y="170" width="150" height="90" fill="#E74C3C" stroke="#C0392B" stroke-width="2" rx="5" />
      <text x="705" y="200" text-anchor="middle" fill="white" font-size="13" font-weight="bold">Cloud SQL</text>
      <text x="705" y="218" text-anchor="middle" fill="white" font-size="9">(PostgreSQL)</text>
      <text x="705" y="235" text-anchor="middle" fill="white" font-size="8">Config, mappings,</text>
      <text x="705" y="249" text-anchor="middle" fill="white" font-size="8">tenant data, forms</text>

      <!-- Cloud Storage -->
      <rect x="630" y="290" width="150" height="70" fill="#3498DB" stroke="#2874A6" stroke-width="2" rx="5" />
      <text x="705" y="315" text-anchor="middle" fill="white" font-size="13" font-weight="bold">Cloud Storage</text>
      <text x="705" y="333" text-anchor="middle" fill="white" font-size="9">(GCS)</text>
      <text x="705" y="348" text-anchor="middle" fill="white" font-size="8">Images, videos</text>

      <!-- Arrow: Upload Media -->
      <line x1="550" y1="250" x2="630" y2="325" stroke="#333" stroke-width="2" marker-end="url(#arrowhead2)" />
      <text x="580" y="295" font-size="10" fill="#666">Upload</text>

      <!-- RBAC Box -->
      <rect x="850" y="140" width="300" height="100" fill="#FFF3CD" stroke="#FFC107" stroke-width="2" rx="5" />
      <text x="1000" y="165" text-anchor="middle" fill="#856404" font-size="11" font-weight="bold">Multi-tenant
        Architecture</text>
      <text x="865" y="190" fill="#856404" font-size="9">Account-level (e.g., Sony Music)</text>
      <text x="875" y="208" fill="#856404" font-size="9">→ Workspace-level (individual labels)</text>
      <text x="865" y="226" fill="#856404" font-size="9">RBAC enforced at API level for tenant isolation</text>

      <!-- Live Updates Box -->
      <rect x="850" y="270" width="300" height="70" fill="#D1ECF1" stroke="#17A2B8" stroke-width="2" rx="5" />
      <text x="1000" y="295" text-anchor="middle" fill="#0C5460" font-size="11" font-weight="bold">Real-time
        Updates</text>
      <text x="865" y="320" fill="#0C5460" font-size="9">Changes available immediately on next NFC tap</text>

      <!-- Infrastructure Box -->
      <rect x="50" y="320" width="560" height="110" fill="#ECF0F1" stroke="#BDC3C7" stroke-width="2" rx="5" />
      <text x="330" y="345" text-anchor="middle" fill="#333" font-size="12" font-weight="bold">Google Cloud Platform
        Infrastructure (europe-west1)</text>
      <text x="70" y="370" fill="#555" font-size="10">• GKE (Kubernetes Engine)</text>
      <text x="70" y="390" fill="#555" font-size="10">• Cloud SQL (managed PostgreSQL)</text>
      <text x="70" y="410" fill="#555" font-size="10">• Cloud Storage (GCS buckets)</text>
      <text x="330" y="370" fill="#555" font-size="10">• Load Balancer + Cloud Armor</text>
      <text x="330" y="390" fill="#555" font-size="10">• TLS 1.2+ encryption for all traffic</text>
      <text x="330" y="410" fill="#555" font-size="10">• Kubernetes Secrets (API keys)</text>

      <!-- Arrow marker definitions -->
      <defs>
        <marker id="arrowhead2" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
          <polygon points="0 0, 10 3, 0 6" fill="#333" />
        </marker>
        <marker id="arrowhead2-gray" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
          <polygon points="0 0, 10 3, 0 6" fill="#666" />
        </marker>
      </defs>
    </svg>

    <div class="section-divider"></div>

    <!-- Internal Admin Flow -->
    <h3 class="flow-title">3. Internal Admin/Support Access</h3>
    <svg viewBox="0 0 1200 350" style="width: 100%; height: auto;">
      <!-- Support Staff -->
      <rect x="50" y="130" width="110" height="70" fill="#95A5A6" stroke="#7F8C8D" stroke-width="2" rx="5" />
      <text x="105" y="155" text-anchor="middle" fill="white" font-size="13" font-weight="bold">Support</text>
      <text x="105" y="173" text-anchor="middle" fill="white" font-size="13" font-weight="bold">Staff</text>
      <text x="105" y="188" text-anchor="middle" fill="white" font-size="8">(Authorized Only)</text>

      <!-- Arrow: HTTPS -->
      <line x1="160" y1="165" x2="240" y2="165" stroke="#333" stroke-width="2" marker-end="url(#arrowhead3)" />
      <text x="200" y="155" text-anchor="middle" font-size="10" fill="#666">1. HTTPS</text>

      <!-- Admin Interface -->
      <rect x="240" y="120" width="130" height="90" fill="#34495E" stroke="#2C3E50" stroke-width="2" rx="5" />
      <text x="305" y="150" text-anchor="middle" fill="white" font-size="13" font-weight="bold">Admin CMS</text>
      <text x="305" y="170" text-anchor="middle" fill="white" font-size="10">Internal</text>
      <text x="305" y="188" text-anchor="middle" fill="white" font-size="10">Interface</text>

      <!-- Arrow: Auth -->
      <line x1="305" y1="120" x2="305" y2="50" stroke="#333" stroke-width="2" marker-end="url(#arrowhead3)" />
      <text x="325" y="80" font-size="10" fill="#666">2. Auth</text>

      <!-- Auth0 -->
      <rect x="245" y="0" width="120" height="50" fill="#EB5424" stroke="#C43E1C" stroke-width="2" rx="5" />
      <text x="305" y="30" text-anchor="middle" fill="white" font-size="13" font-weight="bold">Auth0</text>

      <!-- Return JWT -->
      <line x1="325" y1="50" x2="325" y2="120" stroke="#666" stroke-width="2" marker-end="url(#arrowhead3-gray)"
        stroke-dasharray="5,5" />
      <text x="355" y="80" font-size="10" fill="#666">3. JWT</text>

      <!-- Arrow: API Calls -->
      <line x1="370" y1="165" x2="450" y2="165" stroke="#333" stroke-width="2" marker-end="url(#arrowhead3)" />
      <text x="410" y="155" text-anchor="middle" font-size="10" fill="#666">4. API</text>

      <!-- Backend API -->
      <rect x="450" y="120" width="140" height="90" fill="#9B59B6" stroke="#7D3C98" stroke-width="2" rx="5" />
      <text x="520" y="150" text-anchor="middle" fill="white" font-size="13" font-weight="bold">Backend API</text>
      <text x="520" y="168" text-anchor="middle" fill="white" font-size="10">(Node.js/GKE)</text>
      <text x="520" y="188" text-anchor="middle" fill="white" font-size="8">Admin RBAC</text>
      <text x="520" y="201" text-anchor="middle" fill="white" font-size="8">(Cross-tenant)</text>

      <!-- Arrow: Access Data -->
      <line x1="590" y1="165" x2="670" y2="165" stroke="#333" stroke-width="2" marker-end="url(#arrowhead3)" />
      <text x="630" y="155" text-anchor="middle" font-size="10" fill="#666">5. Query</text>

      <!-- Cloud SQL -->
      <rect x="670" y="120" width="170" height="90" fill="#E74C3C" stroke="#C0392B" stroke-width="2" rx="5" />
      <text x="755" y="150" text-anchor="middle" fill="white" font-size="13" font-weight="bold">Cloud SQL</text>
      <text x="755" y="168" text-anchor="middle" fill="white" font-size="9">(PostgreSQL)</text>
      <text x="755" y="185" text-anchor="middle" fill="white" font-size="8">Customer data, configs,</text>
      <text x="755" y="199" text-anchor="middle" fill="white" font-size="8">forms, tenant settings</text>

      <!-- Access Control Box -->
      <rect x="50" y="250" width="790" height="80" fill="#FFF3CD" stroke="#FFC107" stroke-width="2" rx="5" />
      <text x="445" y="275" text-anchor="middle" fill="#856404" font-size="11" font-weight="bold">Access Control for
        Support Operations</text>
      <text x="65" y="300" fill="#856404" font-size="9">• Separate RBAC roles for internal staff (higher privileges than
        customer users)</text>
      <text x="65" y="318" fill="#856404" font-size="9">• Cross-tenant visibility for support purposes (view customer
        experiences, forms, configurations)</text>

      <!-- Arrow marker definitions -->
      <defs>
        <marker id="arrowhead3" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
          <polygon points="0 0, 10 3, 0 6" fill="#333" />
        </marker>
        <marker id="arrowhead3-gray" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
          <polygon points="0 0, 10 3, 0 6" fill="#666" />
        </marker>
      </defs>
    </svg>

    <!-- Information Boxes -->
    <div class="info-box">
      <h3>Third-Party Subprocessors</h3>
      <div class="info-item">• <strong>Auth0</strong> - Authentication for Studio users and internal staff</div>
      <div class="info-item">• <strong>PassKit</strong> - Mobile wallet passes and messaging</div>
      <div class="info-item">• <strong>Twilio/SendGrid</strong> - Email and messaging notifications</div>
      <div class="info-item">• <strong>Chainstack</strong> - Blockchain timestamping for tag provenance</div>
    </div>

    <div class="info-box" style="border-left-color: #2ECC71;">
      <h3>Infrastructure Providers</h3>
      <div class="info-item">• <strong>Google Cloud Platform</strong> - Hosting infrastructure (region: europe-west1)
      </div>
      <div class="info-item">• <strong>Cloudflare</strong> - Custom domain proxy/CDN (where enabled)</div>
    </div>

    <div class="info-box" style="border-left-color: #95A5A6;">
      <h3>Available Platform Features (Not Active by Default)</h3>
      <div class="info-item">• <strong>Form data pass-through</strong> - Direct integration to client systems (client's
        infrastructure, not stored by ZATAP)</div>
    </div>
  </div>
</body>

</html>